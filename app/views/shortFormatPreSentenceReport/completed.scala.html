@import helper._
@import org.webjars.play.WebJarsUtil

@(message: String, pdfBase64: String)(implicit webJarsUtil: WebJarsUtil)

<style type="text/css">
    body, html {
        height: 100%;
    }
</style>

@main("Report complete - Short Format Pre Sentence Report", false) {

    <h1 class="heading-xlarge">Short Format Pre-Sentence Report</h1>

    <div class="margin-top medium"></div>

    <div class="govuk-box-highlight">

        <h2 class="heading-xlarge">Report complete</h2>

        <p class="font-large">Your report has been created<br/>and uploaded successfully</p>

    </div>

    <p><a href="#" title="What did you think of this service?">What did you think of this service?</a>
        (takes 30 seconds)</p>

    <input class="button" type="submit" value="Finished"/>

    <div class="iframe-container margin-top medium">
        <iframe></iframe>
    </div>

    <script type="text/javascript">
        $(function () {

            $('input').click(function () {
                parent.postMessage('@message', '*');
            });

            if(window.Uint8Array) { // Won't work in IE8/IE9, will work in all other browsers. Don't display PDF result in IE8/IE9

                var pdfBytes = Uint8Array.from(atob('@pdfBase64'), function (c) { return c.charCodeAt(0); });
                var pdfBlob = new Blob([pdfBytes], {type: 'application/pdf'});
                var pdfUrl = URL.createObjectURL(pdfBlob);

                $('iframe').attr('src', pdfUrl);
            }
        });
    </script>
}
